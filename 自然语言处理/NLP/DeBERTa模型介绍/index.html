<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png"><link rel="icon" href="/img/fluid.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="sherwin"><meta name="keywords" content=""><meta name="description" content="DeBERTa系列模型介绍本文是BERT相关系列模型第四篇内容，前三篇见该分类下内容。 1.基本介绍DeBERTa（Decoding-enhanced BERT with disentangled attention）模型是微软在2021年提出的，到现在其实已经迭代了三个版本，第一版发布的时候在SuperGLUE[1]排行榜上就已经获得了超越人类的水平。目前，一些比较有挑战的NLP任务，甚至是N"><meta property="og:type" content="article"><meta property="og:title" content="DeBERTa系列模型介绍"><meta property="og:url" content="http://sherwinzhang.com/%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86/NLP/DeBERTa%E6%A8%A1%E5%9E%8B%E4%BB%8B%E7%BB%8D/index.html"><meta property="og:site_name" content="sherwinNG&#39;s blog"><meta property="og:description" content="DeBERTa系列模型介绍本文是BERT相关系列模型第四篇内容，前三篇见该分类下内容。 1.基本介绍DeBERTa（Decoding-enhanced BERT with disentangled attention）模型是微软在2021年提出的，到现在其实已经迭代了三个版本，第一版发布的时候在SuperGLUE[1]排行榜上就已经获得了超越人类的水平。目前，一些比较有挑战的NLP任务，甚至是N"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h6bo55lipdj210a0d0wh9.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h6bo55lipdj210a0d0wh9.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h6bp3pq0mxj21dw0f4gp1.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h6bp0xrbtuj219o05aq3c.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h6bpc5unlcj219o05agm3.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h6bqdhq901j21960l0abi.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h6c6keuew1j20h003xjrr.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h6c80yrwq8j20tu0f8q55.jpg"><meta property="article:published_time" content="2022-08-20T03:20:21.000Z"><meta property="article:modified_time" content="2023-04-18T23:12:04.000Z"><meta property="article:author" content="sherwin"><meta property="article:tag" content="NLP"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h6bo55lipdj210a0d0wh9.jpg"><meta name="referrer" content="no-referrer-when-downgrade"><title>DeBERTa系列模型介绍 - sherwinNG&#39;s blog</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><script id="fluid-configs">var dntVal,Fluid=window.Fluid||{},CONFIG=(Fluid.ctx=Object.assign({},Fluid.ctx),{hostname:"sherwinzhang.com",root:"/",version:"1.9.3",typing:{enable:!0,typeSpeed:70,cursorChar:"--",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!1,follow_dnt:!0,baidu:null,google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1}},search_path:"/local-search.xml"});CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="sherwinNG's blog" type="application/atom+xml"></head><body><header><div class="header-inner" style="height:100vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>【文言】</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> 归档</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> 分类</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> 标签</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> 关于</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="iconfont icon-books"></i> 文档</a><div class="dropdown-menu" aria-labelledby="navbarDropdown"><a class="dropdown-item" href="https://hexo.fluid-dev.com/" target="_blank" rel="noopener">主题博客 </a><a class="dropdown-item" href="https://hexo.fluid-dev.com/docs/guide/" target="_blank" rel="noopener">配置指南 </a><a class="dropdown-item" href="https://hexo.fluid-dev.com/docs/icon/" target="_blank" rel="noopener">图标用法</a></div></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/default.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="DeBERTa系列模型介绍"></span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2022-08-20 11:20" pubdate>2022年8月20日 上午</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 4.8k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 25 分钟 </span><span id="busuanzi_container_page_pv" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="busuanzi_value_page_pv"></span> 次</span></div></div><div class="scroll-down-bar"><i class="iconfont icon-arrowdown"></i></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 style="display:none">DeBERTa系列模型介绍</h1><div class="markdown-body"><h1 id="deberta系列模型介绍"><a class="markdownIt-Anchor" href="#deberta系列模型介绍"></a> DeBERTa系列模型介绍</h1><blockquote><p>本文是BERT相关系列模型第四篇内容，前三篇见该分类下内容。</p></blockquote><h2 id="1基本介绍"><a class="markdownIt-Anchor" href="#1基本介绍"></a> 1.基本介绍</h2><p>DeBERTa（Decoding-enhanced BERT with disentangled attention）模型是微软在2021年提出的，到现在其实已经迭代了三个版本，第一版发布的时候在SuperGLUE[1]排行榜上就已经获得了超越人类的水平。目前，一些比较有挑战的NLP任务，甚至是NLG任务都会用DeBERTa模型当成预训练模型，进一步微调。</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h6bo55lipdj210a0d0wh9.jpg" srcset="/img/loading.gif" lazyload alt="image-20220919094308225"></p><blockquote><p>图1：DeBERTA V1 模型结构</p><p>来源：<a href="https://www.microsoft.com/en-us/research/blog/microsoft-deberta-surpasses-human-performance-on-the-superglue-benchmark/?lang=fr_ca" target="_blank" rel="noopener">https://www.microsoft.com/en-us/research/blog/microsoft-deberta-surpasses-human-performance-on-the-superglue-benchmark/?lang=fr_ca</a></p></blockquote><p><strong>DeBERTa 模型使用了两种新技术改进了 BERT 和 RoBERTa 模型，同时还引入了一种新的微调方法以提高模型的泛化能力。</strong></p><p>两种新技术的改进：</p><ul><li><strong>注意力解耦机制</strong>：图1右侧黄色部分</li><li>**增强的掩码解码器 ：**图1左侧Enhanced Mask Decoder部分（V3版本中，用其他方法替换）</li></ul><p>新的微调方法：<strong>虚拟对抗训练方法</strong>。</p><p>结果表明，这些技术显著提高了模型预训练的效率以及自然语言理解（NLU）和自然语言生成（NLG）下游任务的性能。</p><p>与 Large-RoBERTa 相比，基于一半训练数据训练的 DeBERTa 模型在很多 NLP 任务中始终表现得更好，MNLI 提高了+0.9%（90.2%–&gt;91.1%），SQuAD v2.0提高了+2.3%（88.4%–&gt;90.7%），RACE提高了+3.6%（83.2%–&gt;86.8%）。</p><p>同时，通过训练由48个Transformer层和15亿参数组成的Large-DeBERTa模型。其性能得到显著提升，单个 DeBERTa 模型在平均得分方面首次超过了 SuperGLUE 基准测试上的表现，同时集成的 DeBERTa 模型目前位居榜首。 截至 2021 年 1 月 6 日，SuperGLUE 排行榜已经超过了人类基线（90.3 VS 89.8）。</p><h2 id="2deberta架构"><a class="markdownIt-Anchor" href="#2deberta架构"></a> 2.DeBERTa架构</h2><h3 id="21-deberta-v1"><a class="markdownIt-Anchor" href="#21-deberta-v1"></a> 2.1 DeBERTa V1</h3><h4 id="211-结构图"><a class="markdownIt-Anchor" href="#211-结构图"></a> 2.1.1 结构图</h4><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h6bo55lipdj210a0d0wh9.jpg" srcset="/img/loading.gif" lazyload alt="image-20220919094308225"></p><blockquote><p>图1：DeBERTa V1模型结构</p></blockquote><h4 id="211-优化点解释"><a class="markdownIt-Anchor" href="#211-优化点解释"></a> 2.1.1 优化点解释</h4><h4 id="a-注意力解耦disentangled-attention"><a class="markdownIt-Anchor" href="#a-注意力解耦disentangled-attention"></a> a) 注意力解耦（Disentangled attention）</h4><ul><li>在BERT 中，输入层的每个单词都使用一个向量来表示，该向量是其单词（内容）嵌入和位置嵌入的总和。</li></ul><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h6bp3pq0mxj21dw0f4gp1.jpg" srcset="/img/loading.gif" lazyload alt="image-20220919101623152"></p><blockquote><p>图2：BERT输入表示. 输入嵌入是token embeddings, segmentation embeddings 和position embeddings 之和。</p></blockquote><ul><li>而 DeBERTa 中的每个单词使用两个对其内容和位置分别进行编码的向量来表示，并且注意力单词之间的权重分别使用基于它们的内容和相对位置的解码矩阵来计算。</li><li>这么做的原因是，经观察发现，单词对的注意力权重不仅取决于它们的内容，还取决于它们的相对位置。 例如，“deep”和“learning”这两个词相邻出现时，它们之间的依赖性比它们出现在不同句子中时要强得多。</li><li>对于序列中位置 i 处的 token，微软使用了两个向量， {H<sub>i</sub>} 和{ P<sub>i|j</sub> }表示它，它们分别表示其内容和与位置 j 处的token的相对位置。 token i 和 j 之间的交叉注意力得分的计算可以分解为四个部分:</li></ul><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h6bp0xrbtuj219o05aq3c.jpg" srcset="/img/loading.gif" lazyload alt="image-20220919101342671"></p><ul><li>也就是说，<strong>一个单词对的注意力权重可以使用其内容和位置的解耦矩阵计算为四个注意力（内容到内容，内容到位置，位置到内容和位置到位置）的得分总和。</strong></li><li>现有的相对位置编码方法在计算注意力权重时使用单独的嵌入矩阵来计算相对位置偏差。 这等效于仅使用上等式中的“内容到内容”和“内容到位置”来计算注意力权重。微软认为位置到内容也很重要，因为单词对的注意力权重不仅取决于它们的内容，还会和相对位置有关。根据它们的相对位置，只能使用内容到位置和位置到内容进行完全建模。 <strong>由于微软使用相对位置嵌入，因此位置到位置项不会提供太多附加信息，因此在实现中将其从上等式中删除。</strong></li></ul><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h6bpc5unlcj219o05agm3.jpg" srcset="/img/loading.gif" lazyload alt="image-20220919102430038"></p><h4 id="b-增强的掩码解码器"><a class="markdownIt-Anchor" href="#b-增强的掩码解码器"></a> b) 增强的掩码解码器</h4><p>DeBERTa和BERT模型一样，也是使用MLM进行预训练的，在该模型中，模型被训练为使用 mask token 周围的单词来预测mask词应该是什么。 DeBERTa将上下文的内容和位置信息用于MLM。 <strong>解耦注意力机制已经考虑了上下文词的内容和相对位置，但没有考虑这些词的绝对位置</strong>，这在很多情况下对于预测至关重要。</p><p>如：给定一个句子“a new store opened beside the new mall”，并用“store”和“mall”两个词 mask 以进行预测。 仅使用局部上下文（即相对位置和周围的单词）不足以使模型在此句子中区分store和mall，<strong>因为两者都以相同的相对位置在new单词之后。 为了解决这个限制，模型需要考虑绝对位置，作为相对位置的补充信息。</strong> 例如，句子的主题是“store”而不是“mall”。 这些语法上的细微差别在很大程度上取决于单词在句子中的绝对位置。</p><p><strong>有两种合并绝对位置的方法。 BERT模型在输入层中合并了绝对位置。 在DeBERTa中，微软在所有Transformer层之后将它们合并</strong>，然后在softmax层之前进行 mask token 预测，如图3 所示。这样，DeBERTa捕获了所有Transformer层中的相对位置，同时解码被mask的单词时将绝对位置用作补充信息 。 此即为 DeBERTa 增强型掩码解码器(EMD)。</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h6bqdhq901j21960l0abi.jpg" srcset="/img/loading.gif" lazyload alt="image-20220919110022829"></p><blockquote><p>图3： 解码器比较</p><p>来源：<a href="https://arxiv.org/pdf/2006.03654.pdf" target="_blank" rel="noopener">https://arxiv.org/pdf/2006.03654.pdf</a></p></blockquote><p>EMD的结构如图2b 所示。 EMD有两个输入(即 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi><mo separator="true">,</mo><mi>H</mi></mrow><annotation encoding="application/x-tex">I,H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8777699999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.07847em">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault" style="margin-right:.08125em">H</span></span></span></span>)。 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.08125em">H</span></span></span></span> 表示来自先前的transformer层的隐藏状态，并且 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.07847em">I</span></span></span></span> 可以是用于解码的任何必要信息，例如，绝对位置嵌入或从先前的EMD层输出。 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">n</span></span></span></span> 表示 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">n</span></span></span></span> 个EMD堆叠层，其中每个EMD层的输出将是下一个EMD层的输入<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.07847em">I</span></span></span></span>，最后一个EMD层的输出将直接输出到语言模型头。 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">n</span></span></span></span> 层可以共享相同的权重。 在实验中，微软设定<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">n=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span></span></span></span> ，即2层共享相同的权重，以减少参数的数量，并使用绝对位置嵌入作为第一个EMD层的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.07847em">I</span></span></span></span>。 当 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi><mo>=</mo><mi>H</mi></mrow><annotation encoding="application/x-tex">I=H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.07847em">I</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.08125em">H</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span> 时，EMD与BERT解码器层相同。 不过，EMD更通用、更灵活，因为它可以使用各种类型的输入信息进行解码。</p><h4 id="c-虚拟对抗训练方法"><a class="markdownIt-Anchor" href="#c-虚拟对抗训练方法"></a> c) 虚拟对抗训练方法</h4><blockquote><p>对抗训练是NLPer经常使用的技术，在做比赛或者公司业务的时候一般都会使用对抗训练来提升模型的性能。DeBERTa预训练里面引入的对抗训练叫SiFT，它攻击的对象不是word embedding，而是embedding之后的layer norm。</p></blockquote><p>规模不变微调(Scale-invariant-Fine-Tuning SiFT)算法一种新的虚拟对抗训练算法， 主要用于模型的微调。</p><p>虚拟对抗训练是一种改进模型泛化的正则化方法。 它通过对抗性样本提高模型的鲁棒性，对抗性样本是通过对输入进行细微扰动而创建的。 对模型进行正则化，以便在给出特定于任务的样本时，该模型产生的输出分布与该样本的对抗性扰动所产生的输出分布相同。</p><p>对于之前的NLP任务，一般会把扰动应用于单词嵌入，而不是原始单词序列。 但是嵌入向量值的范围在不同的单词和模型之间有所不同。 对于具有数十亿个参数的较大模型，方差会变大，从而导致对抗训练有些不稳定。</p><p>受层归一化的启发，微软提出了SiFT算法，该算法通过应用扰动的归一化词嵌入来提高训练稳定性。 即在实验中将DeBERTa微调到下游NLP任务时，<strong>SiFT首先将单词嵌入向量归一化为随机向量，然后将扰动应用于归一化的嵌入向量。</strong> 实验表明，归一化大大改善了微调模型的性能。</p><h3 id="22-deberta-v2"><a class="markdownIt-Anchor" href="#22-deberta-v2"></a> 2.2 DeBERTa V2</h3><p>2021年2月微软放出的 V2 版本在 V1 版本的基础上又做了一些改进：</p><p>**1.词表：**在 v2 中，tokenizer扩的更大，从V1中的50K，变为 128K 的新词汇表。</p><p><strong>2.nGiE(nGram Induced Input Encoding)</strong> v2 模型在第一个转换器层之外使用了一个额外的卷积层，以更好地学习输入标记的依赖性。</p><p>**3.共享位置和内容的变换矩阵：**通过实验表明，这种方法可以在不影响性能的情况下保存参数。</p><p>**4.应用桶方法对相对位置进行编码：**v2 模型使用对数桶对相对位置进行编码。</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h6c6keuew1j20h003xjrr.jpg" srcset="/img/loading.gif" lazyload alt="image-20220919202037239"></p><blockquote><p>图3： DeBERTa V2优化结果对比</p><p>来源：<a href="https://arxiv.org/pdf/2006.03654.pdf" target="_blank" rel="noopener">https://arxiv.org/pdf/2006.03654.pdf</a></p></blockquote><p>优化结果：2.0版几个变更对模型的影响，增大词典效果最显著。</p><h3 id="23-deberta-v3"><a class="markdownIt-Anchor" href="#23-deberta-v3"></a> 2.3 DeBERTa V3</h3><p>2021年11月微软又放出了 V3 版本。<strong>这次的版本在模型层面并没有修改，而是将预训练任务由掩码语言模型（MLM）换成了ELECTRA一样类似GAN的RTD (Replaced token detect) 任务。</strong></p><p>我们知道BERT模型只使用了编码器层和MLM进行训练。而ELECTRA 使用 GAN 的思想，利用生成对抗网络构造两个编码器层进行对抗训练。其中一个是基于MLM训练的生成模型，另一个是基于二分类训练的判别模型。生成模型用于生成不确定的结果同时替换输入序列中的掩码标记，然后将修改后的输入序列送到判别模型。判别模型需要判断对应的 token 是原始 token 还是被生成器替换的 token。</p><p>不同的训练方法实验尝试：</p><ul><li>1、[ES]生成模型和判别模型共享embedding层训练；</li><li>2、[NES]生成模型和判别模型不共享embedding层，也不共享参数层，交替训练；</li><li>3、[GDES]生成模型和判别模型部分共享。</li></ul><p>通过实验表明：</p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h6c80yrwq8j20tu0f8q55.jpg" srcset="/img/loading.gif" lazyload alt="img" style="zoom:50%"><blockquote><p>图3： DeBERTa V3优化结果对比</p><p>来源：<a href="https://arxiv.org/pdf/2111.09543.pdf" target="_blank" rel="noopener">https://arxiv.org/pdf/2111.09543.pdf</a></p></blockquote><p>DeBERTa V3 在某些任务中相比之前模型有不小的涨幅，其中GDES模式优化效果最好。</p><h2 id="3相关code"><a class="markdownIt-Anchor" href="#3相关code"></a> 3.相关code</h2><p>DeBERTa官方文档，可以直接调库实现：</p><ul><li>DeBERTa code_1: <a href="https://deberta.readthedocs.io/en/latest/index.html" target="_blank" rel="noopener">https://deberta.readthedocs.io/en/latest/index.html</a></li></ul><p>haggingface实现DeBERTa，可以直接调库实现：</p><ul><li>DeBERTa code_2: <a href="https://huggingface.co/docs/transformers/model_doc/deberta" target="_blank" rel="noopener">https://huggingface.co/docs/transformers/model_doc/deberta</a></li></ul><p>官方源码：</p><ul><li>DeBERTa code_3: <a href="https://github.com/microsoft/DeBERTa" target="_blank" rel="noopener">https://github.com/microsoft/DeBERTa</a></li></ul><h2 id="4总结"><a class="markdownIt-Anchor" href="#4总结"></a> 4.总结</h2><ul><li>1.DeBERTa V1 相比 BERT 和 RoBERTa 模型的改进：<ul><li>两种技术改进：<ul><li>注意力解耦机制</li><li>增强的掩码解码器</li></ul></li><li>新的微调方法：虚拟对抗训练方法(SiFT)。</li></ul></li><li>2.DeBERTa V2 改进<ul><li>tokenizer扩的更大（优化效果最明显）</li><li>transformer外使用了额外的卷积层</li><li>共享位置和内容的变换矩阵</li><li>应用桶方法对相对位置进行编码</li></ul></li><li>3.DeBERTa V3 改进<ul><li>在模型层面并没有修改，将预训练任务MLM换成了ELECTRA一样类似GAN的RTD任务</li></ul></li></ul><h2 id="5参考文献"><a class="markdownIt-Anchor" href="#5参考文献"></a> 5.参考文献</h2><p>[1] SuperGLUE: <em><a href="https://super.gluebenchmark.com/leaderboard" target="_blank" rel="noopener">https://super.gluebenchmark.com/leaderboard</a></em></p><p>[2] DeBERTa: <a href="https://arxiv.org/pdf/2006.03654.pdf" target="_blank" rel="noopener">https://arxiv.org/pdf/2006.03654.pdf</a></p><p>[3] DeBERTa 2.0: <a href="https://huggingface.co/docs/transformers/model_doc/deberta-v2" target="_blank" rel="noopener">https://huggingface.co/docs/transformers/model_doc/deberta-v2</a></p><p>[4] DeBERTa 3.0: <a href="https://arxiv.org/pdf/2111.09543.pdf" target="_blank" rel="noopener">https://arxiv.org/pdf/2111.09543.pdf</a></p><p>[5] 微软 deDERTa 官网: <a href="https://www.microsoft.com/en-us/research/blog/microsoft-deberta-surpasses-human-performance-on-the-superglue-benchmark/?lang=fr_ca" target="_blank" rel="noopener">https://www.microsoft.com/en-us/research/blog/microsoft-deberta-surpasses-human-performance-on-the-superglue-benchmark/?lang=fr_ca</a></p></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86/" class="category-chain-item">自然语言处理</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/NLP/">#NLP</a></div></div><div class="license-box my-3"><div class="license-title"><div>DeBERTa系列模型介绍</div><div>http://sherwinzhang.com/自然语言处理/NLP/DeBERTa模型介绍/</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>sherwin</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2022年8月20日</div></div><div class="license-meta-item"><div>许可协议</div><div><a target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/%E7%A8%8B%E5%BA%8F%E4%BA%BA%E7%94%9F/%E7%A8%8B%E5%BA%8F%E4%BA%BA%E7%94%9F/%E3%80%8A%E4%BA%BA%E4%B8%96%E9%97%B4%E3%80%8B%E5%B0%8F%E8%AF%B4%E5%B7%B2%E9%98%85/" title="《人世间》小说已阅"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">《人世间》小说已阅</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86/NLP/RoBERTa%EF%BC%9A%E4%B8%80%E7%A7%8D%E7%A8%B3%E5%81%A5%E4%BC%98%E5%8C%96BERT%E7%9A%84%E9%A2%84%E8%AE%AD%E7%BB%83%E6%96%B9%E6%B3%95/" title="RoBERTa：一种稳健优化BERT的预训练方法"><span class="hidden-mobile">RoBERTa：一种稳健优化BERT的预训练方法</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments" lazyload><div id="lv-container" data-id="city" data-uid="MTAyMC81NzExNy8zMzU4MQ=="><script type="text/javascript">Fluid.utils.loadComments("#lv-container",function(){Fluid.utils.createScript("https://cdn-city.livere.com/js/embed.dist.js")})</script><noscript>Please enable JavaScript to view the comments</noscript></div></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div><div class="statistics"><span id="busuanzi_container_site_pv" style="display:none">总访问量 <span id="busuanzi_value_site_pv"></span> 次 </span><span id="busuanzi_container_site_uv" style="display:none">总访客数 <span id="busuanzi_value_site_uv"></span> 人</span></div><div class="beian"><span><a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">京ICP证1024号 </a></span><span><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=10241024" rel="nofollow noopener" class="beian-police" target="_blank"><span style="visibility:hidden;width:0">|</span> <img src="/img/police_beian.png" srcset="/img/loading.gif" lazyload alt="police-icon"> <span>京公网安备1024号</span></a></span></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t){var e=Fluid.plugins.typing;(t=t.getElementById("subtitle"))&&e&&e(t.getAttribute("data-typed-text"))}((window,document))</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js",function(){var t,o=jQuery("#toc");0!==o.length&&window.tocbot&&(t=jQuery("#board-ctn").offset().top,window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-t},CONFIG.toc)),0<o.find(".toc-list-item").length&&o.css("visibility","visible"),Fluid.events.registerRefreshCallback(function(){var t;"tocbot"in window&&(tocbot.refresh(),0!==(t=jQuery("#toc")).length&&tocbot&&0<t.find(".toc-list-item").length&&t.css("visibility","visible"))}))})</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback(function(){if("anchors"in window){anchors.removeAll();var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}})})</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>